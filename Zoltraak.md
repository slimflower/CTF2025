# Mô tả 

<img width="682" alt="Ảnh màn hình 2025-01-18 lúc 23 53 46" src="https://github.com/user-attachments/assets/15cfe636-8485-4144-b3cb-d9e8026ac2c1" />

<img width="564" alt="Ảnh màn hình 2025-01-18 lúc 23 54 07" src="https://github.com/user-attachments/assets/4027e433-8db0-47dc-9310-ffab5e2db8fb" />

# Giải pháp 
- Sau khi em đọc qua một lượt code thì em thấy bài này sử dụng `n=p*p*q` không phải là một dạng mô-đun RSA tiêu chuẩn `n=p*p`, mà là một dạng mô-đum đặc biệt .Vì vậy em cần phân tích cái mô-đum đặc biệt này để tìm ra q và p và sử dụng hint để giải d và khôi phục flag.
- Ngồi mò 1 hồi thì em không thể tính toán q và p từ mô-đum `n=p*p*q`. Vì vậy em đi search về bài này thì may mắn là em thấy 1 link nó có cả solution  https://www.cnblogs.com/LynneHuan/p/14725645.html
  
<img width="1089" alt="Ảnh màn hình 2025-01-19 lúc 00 01 20" src="https://github.com/user-attachments/assets/9a305ac0-3428-45cf-86f2-7749c07fb7db" />

- Sau khi tham khảo solution bài trên thì em phân tích được để phân tích tìm ra q với p em cần sử dụng `hint=pow(d, e, n)` để tạo mối liên quan đến `p**2` thông qua `mod(p*(p-1)*(q-1))`.
- Sau đó em xây dựng `x = hint * pow(e, e) - 1` với mục đích để làm p thành ước chung lớn nhất sau đó em tìm p bằng hàm `p=gcd(n,x)` là ước chung của n và x.
- Và bây giờ em tìm q thông qua `q= n//(p**2)`. Khi đã tìm được q và p thì em tính khoá d và tính được m(flag) thông qua `m= pow(c, d, n)` và chuyển m từ số nguyên sang kí tự để hiện flag vì ban đầu m bị chuyển từ byte sang long của flag.

```py
c = 216895836421936226664808806038131495725544658675106485670550453429609078893908601117272164909327632048129546753076380379045793859323244310633521321055388974634549104918284811813205866773238823220320222756056839297144222443834324484452750837978501262424186119512949111339142374067658940576220209924539508684423305539352188419127746551691195133913843198343764965016833190033138825402951884225991852311634388045499747652928427089105006744062452013466170009819761589
hint = 119347490709709918515362500613767389632792382149593771026067086829182731765211255478693659388705133600879844115195595226603111752985962235917359759090718061734175658693105117154525703606445141788266279862259884063386378441258483507592794727728695131221071650602175884547070684687593047276747070248401583807925835550653444240529379502255688396376354105756898403267623695663194584556369065618489842778593026855625193720218739585629291162493093893452796713107895772
n = 947166029378215681573685007119017666168984033297752775080286377779867377305545634376587741948207865073328277940177160532951778642727687102119230712410226086882346969888194915073996590482747649286982920772432363906920327921033567974712097884396540431297147440251083706325071265030933645087536778803607268099965990824052754448809778996696907531977479093847266964842017321766588821529580218132015882438704409614373340861025360688571007185362228026637160817305181421

import gmpy2
from sympy import gcd
from Crypto.Util.number import *
e= 65537
x = hint * pow(e, e) - 1
p = gmpy2.gcd(n, x)
q= n//(p**2)
d = inverse(e, p * (p-1) * (q-1))
m= pow(c, d, n)
print(long_to_bytes(m))
```
- Chạy code và em đã tìm được flag :

  <img width="296" alt="Ảnh màn hình 2025-01-19 lúc 00 04 24" src="https://github.com/user-attachments/assets/6d9631d8-2961-4c85-a568-d31205984409" />

- Flag: `KCSC{0ne_p_1s_Enough_:vvvvv}`
